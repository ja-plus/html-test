<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.1.2/echarts.common.js"></script>
<!-- <script src="https://cdn.bootcdn.net/ajax/libs/echarts/4.9.0-rc.1/echarts-en.common.min.js"></script> -->
<body>
    <div id="echarts" style="height: 600px;width:800px"></div>
</body>
<script>
    let myChart = window.echarts.init(document.getElementById("echarts"));
    let base = +new Date(1988, 9, 3);
    let oneDay = 24 * 3600 * 1000;
    let data = [[base, Math.random() * 300]];
    for (let i = 1; i < 1000; i++) {
      let now = new Date((base += oneDay));
      data.push([+now, Math.round((Math.random() - 0.5) * 20 + data[i - 1][1])]);
    }
    let tmpArr = []; // 存放已经显示的年份数组
    let option = {
      tooltip: {
        trigger: "axis",
        position: function (pt) {
          return [pt[0], "10%"];
        },
      },
      grid: {
        bottom: 90,
      },
      title: {
        left: "center",
        text: "Large Ara Chart",
      },
      toolbox: {
        feature: {
          dataZoom: {
            yAxisIndex: "none",
          },
          restore: {},
          saveAsImage: {},
        },
      },
      xAxis: {
        type: "time",
        boundaryGap: false,
        axisLabel: {
          formatter: (val, index) => {
            let date = new Date(val).toLocaleDateString().replace(/\//g, "-");
            let year = date.substring(0, 4);
            console.log(date, index);
            if (!tmpArr.includes(year)) {
              tmpArr.push(year);
              // return `{y|${year}}-${date.substring(5)}`; // 年份不换行方案
              // return `${date.substring(5)}\n{verticalLine||}\n${year}`; // 方案1画竖线
              return `${date.substring(5)}\n{paddingLeft|}{verticalLine|}\n${year}`; // 方案2画竖线
            }
            return `${date.substring(5)}`;
          },
          rich: {
            // 年份不换行方案
            // y: {
            //     fontWeight: 'bolder'
            // }
            // -----方案1画竖线
            // verticalLine: {
            //     align: 'left',
            //     padding: 8,
            //     fontSize: 6,
            //     fontWeight: 'bolder',
            //     lineHeight: 12
            // }
            // -----end 方案1
            // -----方案2画竖线
            paddingLeft: {
              align: "left",
              width: 8,
            },
            verticalLine: {
              align: "left",
              borderColor: "#000",
              borderWidth: 0.5, // 由于是左右border，所以画0.5 + 0.5 = 1
              height: 6,
            },
            // ----- end 方案2
          },
        },
      },
      yAxis: {
        type: "value",
        boundaryGap: [0, "100%"],
      },
      dataZoom: [
        { type: "inside", start: 0, end: 20 },
        { start: 0, end: 20 },
      ],
      series: [
        {
          name: "Fake Data",
          type: "line",
          smooth: true,
          symbol: "none",
          areaStyle: {},
          data: data,
        },
      ],
    };
    myChart.setOption(option);
    myChart.on("datazoom", () => {
      tmpArr = []; // 拖动dataZoom 时，重置该数组
    });
</script>

</html>