<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>webPPT</title>
</head>
<style>
  * {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    background-color: #000;
  }

  .web-ppt {
    position: relative;
    height: 100vh;
    width: 100%;
    /* overflow: auto; */
    overflow: hidden;
    /* scroll-snap-type: y mandatory; */
  }

  .page {
    width: 100%;
    height: inherit;
    background-color: #fff;
    padding: 10px 20px;
    /* scroll-snap-align: start; */
    overflow: hidden;
    position: absolute;
    left: 0;
    top: 0;
    transform: translateY(100vh);
    transition: transform 0.5s ease, width 0.2s ease, height 0.2s ease, left 0.2s ease, top 0.2s ease;
  }

  .page.active {
    transform: translateY(0);
  }

  .page.leave {
    transform: translateY(-100vh);
  }
  .page.mini-hover:hover{
    box-shadow: 0 0 50px rgba(255,255,255,0.7)
  }

  .page:nth-child(1) {
    background-attachment: fixed;
    background-image: repeating-linear-gradient(45deg, #aaa 0 10%, #fff 10% 20%);
  }

  .page:nth-child(2) {
    background-color: #ccc;
  }

  .efc {
    display: flex;
    flex-direction: column;
  }

  .title-page {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }
</style>

<body>
  <div class="web-ppt">
    <div class="page title-page">
      <h1 style="font-size: 80px">主标题</h1>
      <h2 style="color: #555">副标题</h2>
    </div>
    <div class="page">
      <h1>标题</h1>
      <div style="display:flex;justify-content:center;align-items: center;">
        <p style="width: 50%">
          正文 正文 正文 正文 正文 正文 正文
        </p>
      </div>
    </div>
    <div class="page">
      <h1 style="">你好3</h1>
    </div>
    <div class="finish">
      finish
    </div>
  </div>
</body>
<script>
  let wp = document.querySelector(".web-ppt");
  let pages = document.querySelectorAll(".web-ppt>.page");
  let _isMini = false;
  let i = 0;
  pages.forEach((page, i) => {
    page.id = "page" + i;
    page.addEventListener("click", (e) => {
      if (_isMini) {
        e.stopPropagation(); // stop to wp.addEventListener('click'
        i = Number(e.target.id.match(/\d+/)[0]);
        for (let j = 0; j < i; j++) {
          pages[j].classList.remove("active");
          pages[j].classList.add("leave");
        }
        pages[i].classList.remove("leave");
        pages[i].classList.add("active");
        for (let j = i + 1; j < pages.length; j++) {
          pages[j].classList.remove("leave");
          pages[j].classList.remove("active");
        }
        toggleMiniPage();
      }
    });
  });
  wp.addEventListener("wheel", (e) => {
    if (e.wheelDeltaY < 0) {
      nextPage();
    } else {
      lastPage();
    }
  });
  wp.addEventListener("click", (e) => {
    nextPage();
  });

  function nextPage() {
    if (!_isMini && i <= pages.length) {
      pages[i - 1]?.classList.remove("active");
      pages[i - 1]?.classList.add("leave");
      pages[i].classList.add("active");
      i++;
    }
  }
  function lastPage() {
    if (!_isMini && i > 0) {
      i--;
      pages[i].classList.remove("active");
      pages[i - 1]?.classList.remove("leave");
      pages[i - 1]?.classList.add("active");
    }
  }

  window.addEventListener("keydown", (e) => {
    e.preventDefault();
    if (e.shiftKey && e.code === "Tab") {
      console.log("tab");
      toggleMiniPage();
    }
  });
  window.addEventListener("keyup", (e) => {
    e.preventDefault();
  });
  window.addEventListener("blur", (e) => {});

  function toggleMiniPage() {
    const scale = 0.2;
    const gap = 20;
    const miniWidth = window.innerWidth * scale;
    const minHeight = window.innerHeight * scale;
    _isMini = !_isMini;
    pages.forEach((page, i) => {
      if (_isMini) {
        page.style.cssText = `left: ${i * miniWidth + gap * (i + 1)}px; top:${
          Math.floor(i / 4) * minHeight + 10
        }px; transform-origin: left top;transform:scale(${scale});border:1px solid #aaa`;
        // page.style.cssText = `width:300px;height:200px;left: ${i * 300 + 20 * (i + 1)}px;top: ${Math.floor(i / 4) * 200 + 10}px;transform:none;border:1px solid #aaa`;
        page.classList.add("mini-hover");
      } else {
        page.style.cssText = "transform-origin: left top;";
        page.classList.remove("mini-hover");
      }
    });
  }
</script>

</html>